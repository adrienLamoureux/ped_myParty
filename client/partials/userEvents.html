<!-- UserEvents Template -->
<!--Menu-->
<nav id="mineEventNav">
	<div class="row">
		<button id="bt_organised" type="button" class="btn btn-primary col-sm-6 col-xs-12" ng-click="organised=true; participed=false;">Les événements que j'organise</button>
		<button id="bt_participed" type="button" class="btn btn-primary col-sm-6 col-xs-12" ng-click="organised=false; participed=true;">Les événements auxquels je participe</button>
	</div>
	<div class="search row">
		<div class="col-xs-12 col-xs-offset-0 col-sm-6 col-sm-offset-3 col-md-6 col-md-offset-3 col-lg-6 col-lg-offset-3 ">
			<div class="input-group">
				<span class="input-group-addon glyphicon glyphicon-search" id="basic-addon1"></span>
				<input value="barre de recherche" class="form-control" type="text" ng-model="search.title" aria-describedby="basic-addon1">
			</div>
		</div>
	</div>
</nav>

<!--Organisés-->
<div id="content" ng-show="organised">
	<h1> Revenu global : {{income}} €</h1>
	<div class="container">
		<div id="mineEvents" ng-repeat="event in events  | filter:search" class="col-lg-4 col-md-6 col-sm-6 col-xs-12 text-center">		
			<h2>{{event.title}}</h2>
			<!-- picture -->
			<a id="eventSmallImage{{$index+1}}" class="eventSmallImage col-lg-10 col-lg-offset-1 col-md-10 col-md-offset-1 col-sm-10 col-sm-offset-1 col-xs-10 col-xs-offset-1" id="show{{$index+1}}" href="#/event/{{event._id}}"><img ng-src="data:{{event.imageSmall.filetype}};base64,{{event.imageSmall.base64}}" class="img-thumbnail" alt="{{event.title}}"></a>
			
			<!-- income -->
			<table id="income{{$index+1}}" class="income col-lg-12">
				<tr>
					<th>Ventes</th>
					<th class="col-lg-8 text-center">Type billet (Qté)</th>
					<th>Prix</th>
					<th>Total</th>
				</tr>
				<tr id="ticketTypeIncome{{$index+1}}" ng-repeat="ticketType in event.ticketsType">
					<td class="col-lg-1 text-right">{{ticketType.sold}}</td>
					<td class="col-lg-8 text-center">{{ticketType.type}} ({{ticketType.ticketLeft + ticketType.sold}})</td>
					<td class="col-lg-1 text-right">{{ticketType.price}}</td> 
					<td class="col-lg-2 text-right">{{ticketType.income}}</td>
				</tr>
				<tr id="totalIncome{{$index+1}}">
					<th class="text-right" colspan="3"> Revenu Total :</th>
					<td class="text-right"> {{event.income}}€</td>
				</tr>
			</table>	

			<!-- management -->
			<div id="management{{$index+1}}" class="management col-lg-12 text-right">	
				<a id="edit{{$index+1}}" ng-hide="event.online" class="btn btn-primary" ng-href="#/event/{{event._id}}/edit">
					Editer
				</a>
				<button id="publish{{$index+1}}" ng-hide="event.online || dateExpired(event.dateStarting)" class="btn btn-primary" ng-click="publish(event)" >
					Publier
				</button>
				<button id="delete{{$index+1}}" ng-hide="event.online" class="btn btn-danger" ng-click="delete(event)">
					Supprimer
				</button>
				<button id="cancel{{$index+1}}" ng-show="event.online && !dateExpired(event.dateStarting)" class="btn btn-danger" ng-click="cancel(event)">
					Annuler
				</button>
				<span id="noActions{{$index+1}}" ng-show="event.online && dateExpired(event.dateStarting)" class="span-text span-error">
					Evénement en cours ou expiré !
					<br/>(aucune action possible)
				</span>
			</div>
	
		</div>
	</div>
</div>

<div ng-show="participed">
	<div class="container text-center" ng-repeat="event in participatedEvent | filter:search">
		<event-miniature></event-miniature>
	</div>
</div>